<!DOCTYPE html> 
<html> 
<head> 

    <title>Test Sandbox Page</title> 
   
     <script type="text/javascript">
        (function(){
      
          // Create a queue, but don't obliterate an existing one!
          var analytics = window.analytics = window.analytics || [];
      
          // If the real analytics.js is already on the page return.
          if (analytics.initialize) return;
      
          // If the snippet was invoked already show an error.
          if (analytics.invoked) {
            if (window.console && console.error) {
              console.error('Segment snippet included twice.');
            }
            return;
          }
      
          // Invoked flag, to make sure the snippet
          // is never invoked twice.
          analytics.invoked = true;
      
          // A list of the methods in Analytics.js to stub.
          analytics.methods = [
            'trackSubmit',
            'trackClick',
            'trackLink',
            'trackForm',
            'pageview',
            'identify',
            'reset',
            'group',
            'track',
            'ready',
            'alias',
            'debug',
            'page',
            'once',
            'off',
            'on',
            'addSourceMiddleware', 
            'addDestinationMiddleware'
          ];
      
          // Define a factory to create stubs. These are placeholders
          // for methods in Analytics.js so that you never have to wait
          // for it to load to actually record data. The `method` is
          // stored as the first argument, so we can replay the data.
          analytics.factory = function(method){
            return function(){
              var args = Array.prototype.slice.call(arguments);
              args.unshift(method);
              analytics.push(args);
              return analytics;
            };
          };
      
          // For each of our methods, generate a queueing stub.
          for (var i = 0; i < analytics.methods.length; i++) {
            var key = analytics.methods[i];
            analytics[key] = analytics.factory(key);
          }
      
          // Define a method to load Analytics.js from our CDN,
          // and that will be sure to only ever load it once.
          
          // Source middleware function
          var smw1 = function({payload, next, integrations}) {
            
            // Regex matches basic email address like "joe@doe.com"
            const regex = /\S+@\S+\.\S+/
            const contextPageUrl = payload.obj.context.page.url
            const propsPageUrl = payload.obj.properties.url

            // If the event is page() and either properties.url or context.page.url match the Regex:
            //  - change the URL string to "My generic URL..."
            if (payload.type() == "page" && (regex.test(contextPageUrl) || regex.test(propsPageUrl))) {
              payload.obj.context.page.url = "My generic URL in context"
              payload.obj.properties.url = "My generic URL in properties"
              console.log("URL update")
            }
            next(payload)
          }

          analytics.addSourceMiddleware(smw1);

          
          //analytics.addDestinationMiddleware('Google Analytics', [dmw1])

          analytics.load = function(key, options){
            // Create an async script element based on your key.
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.async = true;
            script.src = 'https://cdn.segment.com/analytics.js/v1/'
              + key + '/analytics.min.js';
      
            // Insert our script next to the first script element.
            var first = document.getElementsByTagName('script')[0];
            first.parentNode.insertBefore(script, first);
            analytics._loadOptions = options;
          };
      
          // Add a version to keep track of what's in the wild.
          analytics.SNIPPET_VERSION = '4.1.0';
      
          // Load Analytics.js with your key, which will automatically
          // load the tools you've enabled for your account. Boosh!
          analytics.load("Ec8iixgxxjzpglKbxKjESW2JrkOko18y"); //JS writekey
          // analytics.load("KtJRf5H0szmjxemhJbgWltw6DJ38iHyB") // AMP writekey
          //analytics.load("TABPkIq0k1HtaB1YZmQHyZpalBV2HpSC") // AMP JS 
          //analytics.page({},{ context: { ip: "0.0.0.0" }});
          analytics.page()
      
          // Make the first page call to load the integrations. If
          // you'd like to manually name or tag the page, edit or
          // move this call however you'd like.
          //analytics.page();
        })();
      
      </script>
      <script>
        (function(apiKey){
            (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
            v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
                o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
                y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
                z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');
    
                // Call this whenever information about your visitors becomes available
                // Please use Strings, Numbers, or Bools for value types.
                pendo.initialize({
                    visitor: {
                        id:              'VISITOR-UNIQUE-ID'   // Required if user is logged in
                        // email:        // Recommended if using Pendo Feedback, or NPS Email
                        // full_name:    // Recommended if using Pendo Feedback
                        // role:         // Optional
    
                        // You can add any additional visitor level key-values here,
                        // as long as it's not one of the above reserved names.
                    },
    
                    account: {
                        id:           'ACCOUNT-UNIQUE-ID' // Highly recommended
                        // name:         // Optional
                        // is_paying:    // Recommended if using Pendo Feedback
                        // monthly_value:// Recommended if using Pendo Feedback
                        // planLevel:    // Optional
                        // planPrice:    // Optional
                        // creationDate: // Optional
    
                        // You can add any additional account level key-values here,
                        // as long as it's not one of the above reserved names.
                    }
                });
        })('5b9886bd-c672-4ec8-5d19-01eed141fd6a');
    </script>
 
   

</head> 


<body> 
 
<p>First form</p>
<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
 <!-- 
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
	portalId: "7457584",
  formId: "714f581e-86b4-4382-ba11-d26b37714101"
});
</script>
-->

<!--
<h1>Video</h1>
<br>
<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
<img
  style="width: 100%; margin: auto; display: block;"
  class="vidyard-player-embed"
  src="https://play.vidyard.com/moVpmjzws1KqgAaTadxX6C.jpg"
  data-uuid="moVpmjzws1KqgAaTadxX6C"
  data-v="4"
  data-type="inline"
/>

<script type="text/javascript">
/*
window.onVidyardAPI = (vidyardEmbed) => {
 vidyardEmbed.api.addReadyListener((_, player) => {

console.log('player ready:', player.ready());
 console.log(player.uuid);
 // put your code here

}, "moVpmjzws1KqgAaTadxX6C")

 }
 */
</script>
<script type="text/javascript">
window.onVidyardAPI = (vidyardEmbed) => {
 vidyardEmbed.api.addReadyListener((_, player) => {

//The below code will send Play, Pause and End Reached events for the first Vidyard player available within your HTML

var video = VidyardV4.players[0];

 video.on("play", function() {
  analytics.track("Video Started", {
          video_name: video.metadata.name,
          video_action: 'Play',
          category: 'Video Events',
          label: video.metadata.name  
        },
        {
          integrations:
          {
            'All':true
          }
      }); 
  }); 
 video.on("pause", function() { 
  analytics.track("Video Paused", {
          video_name: video.metadata.name,
          video_action: 'Pause',
          category: 'Video Events',
          label: video.metadata.name
        },{
          integrations:
          {
            'All':true
          }
      }); 
 }); 
 video.on("playerComplete", function() { 
  analytics.track("Video Completed", {
          video_name: video.metadata.name,
          video_action: 'Complete',
          category: 'Video Events',
          label: video.metadata.name
        },{
          integrations:
          {
            'All':true
          }
      }); 
 }); 
 
}, )
 }
</script>
-->
<!--
<h1>Outgrow quiz</h1>
<br>
<div><div class='op-interactive' id='5f9811e9e76f2a78f666e470' data-title='eap test quiz' data-url='https://segment.outgrow.us/5f9811e9e76f2a78f666e470?vHeight=1' data-width='100%'></div><script src='//dyv6f9ner1ir9.cloudfront.net/assets/js/nloader.js'></script><script>initIframe('5f9811e9e76f2a78f666e470');</script></div>
-->
<h1>First JS page</h1> 
<a href="http://longstoryshort.github.io/ampp.html">AMP page LSS</a>



<br>
<br>
<br>


<a id='quiz_link' 
   href="https://segment423.outgrow.us/segment423-4?anon_id="
   title="Quiz!"
   >Quiz link</a>

<script type="text/javascript">
  // Get anonymous Id from localStorage. Remove the quotes
  var anon_id = localStorage.getItem("ajs_anonymous_id").replace(/"/g,"")
  // Get quiz link tag
  var link = document.getElementById("quiz_link")
  // Get quiz URL from the tag
  var cur_href = link.getAttribute("href")
  // Append anonymous Id to the URL
  link.setAttribute("href", cur_href + anon_id)
</script>



<p>I am building a directory of the sweetest travel destinations.</p>  
<form name="travel" onsubmit="identify(event)">
     What is your favorite travel destination?
    <input name="destination" required="" size="81" type="text"/> 
    <br><br><br> 
    Any recommendations (cool things to do, places to visit or restaurants to eat)? 
    <br><br> 
    <textarea cols="81" name="details" required="" rows="10">
    </textarea> 
    <br><br> 
    Name: <input name="fullname" required="" size="75" type="text"/> 
    <br><br> 
    Email: <input name="email" required="" size="75" type="email"/> 
    <br><br>
    <br><br>
    <input name="submit" type="submit" value="submit"/>
</form> 
<div id="target-container"></div>

<script type="text/javascript">
    function identify(e){
      e.preventDefault();
      var form = e.target;
      var email = form["email"].value;
      var fullname = form["fullname"].value;
      var destination = form["destination"].value;
      var details = form["details"].value;
      //var userId = form["userId"].value;
      
      var user = {
          email: email, 
          name: fullname, 
          destination: destination, 
          details: details
      };
        
       
      analytics.identify("", {
            email: email, 
            name: fullname,
          }
        );


    analytics.track("Order Completed", {
        name: btoa(fullname),
        email: btoa(email),
        ts: "2020-05-05T10:52:30-07:00",
        array_prop: ["apple-a","banana-a","pear-a"],
        string_prop: "apple-s, banana-s, pear-s",
        category: "Test Category",
        }
        
        ); 
        /*
        {
            context: {
              ip: "0.0.0.0",
              
                location: { 
                    city: "San Francisco",
                    country: "United States",
                    latitude: 40.2964197,
                    longitude: -76.9411617 
                }
            }
        }
        analytics.track("GA Event v2", {
          category: "MW Category",
        }); 
        analytics.track(details, {
          category: name,
        }); 
        */
      
      }
</script>
   
</body> 
</html>